多核芯片的低功耗温敏调度研究
On Temperature and Power Management for MPSoC
实时功耗管理；实时温度管理；任务调度；热分析；多核片上系统；体系结构级分析
 Dynamic Power Management, Dynamic Temperature Management, Task Scheduling, Thermal Analysis, MPSoC, Architecture Level

当前，面向复杂应用的高性能片上系统为了规避和减轻功耗墙问题，延续摩尔定律，采用了实时温度功耗管理与多核并行计算结构两种主要的技术手段。实时功耗温度管理通过对任务的准确预测与合理调度，可以有效地降低片上系统的运行能耗与峰值温度。为了获得更好的实时功耗温度管理调度效果，基于精确任务负载预测模块，本文在第一部分提出了一种新颖的任务调度算法VP-TALk，并结合已有的多种流行调度算法，构建了一个完整的实时功耗温度管理原型系统。本文首先分析并总结已有的三种较为流行的实时系统调度算法。在此基础上，提出VP-TALk算法。该算法通过计算出最优电压-频率对的理想值，进而选择出两组与理想值相邻的电压-频率对，获得两个现实的工作状态。 VP-TALk算法将任务负载分配到这两个工作状态，考虑核心温度和任务实时性的条件，以获得最优的实时功耗温度管理效果。最后基于简单地机器学习方法，我们综合四种源算法、构建了一套完整的实时功耗温度管理原型系统。实验结果表明：当本文系统的任务预测组合模块达到平均误差2.89%时，在相同的峰值温度约束下，与已有调度算法的能耗值相比，尽管假设了更为敏感的功率-温度影响关系，但对于较高的工作负载率，本文所提出的VP-TALk调度算法仍能够获得平均14.33%的能耗降低；本文所提出实时功耗温度管理原型系统可以获得接近于理想的能耗优化效果。多核片上系统的低功耗设计与温敏规划布局都需要高效精确的热分析方法作为支撑。本文采用了更为简单地热系统建模方法，对多核片上系统的热分析方法进行了探索，并且得到了三种具有不同算法复杂度与精度的热分析方法，分别为模块级方法、核级方法、考虑本核内模块相互影响的改良核级方法。这些算法具有简单、高效、与现有简化模型兼容、易于扩展、能够解决温度对漏电流的影响等优点。实验数据表明：对核数较多的多核片上系统进行热分析的时候，CoreTAM算法的复杂度低但精度也低，BlockTAM算法的精度高但复杂度也高，而BlockInsideCoreTAM则具有算法复杂度低和精度高的优点。算法可以将局部热点的峰值温度增量平均误差控制在4%以下，热分析耗时实现了近50倍以上的分析加速；采用BlockInsideCoreTAM等增量式的热分析建模方法，可以快速进行用于降低热点温度的多核片上系统布图规划过程。
To tackle the Power Wall problem on high performance chip processors oriented for heavy-load applications and continue Moore’s Rule, Dynamic Power and Temperature Management (DPTM) and Multi-chip Processor Architecture are adopted in the field of Integrated Circuits (IC) design. Optimal DPTM methods can effectively cut down the soaring power consumption and alleviate the problem of chip temperature. In order to get better scheduling results, this paper mainlyaccomplish three things. First, with principles derived from analyzing three previous methods as thumb rules, we obtain an improved DPTM algorithm, named VP-TALk, that carefully schedule the processor’s running and dormant behaviors. Besides, we propose a combined predicting model. It may predict the workload on the chip so as to draw out optimal but unpractical frequency (F) and voltage (V). This F & V pair decides two distinct pairs of F & V, with which VP-TALK schedules the processor according to both the core temperature and remaindering work load. Finally, combining the workload prediction method and four DPTM algorithms, we further build a DPTM control system. Even though our model assume a tighter and more sensitive relationship between energy and temperature, experiments show that: 1) the workload prediction’s error is as less as 2.89%; 2) under even more tough assumptions about thermal and power interrelation and the same peak temperature ceiling value, our proposed DPTM algorithm gains averagely 14.33% energy saving comparing to previous algorithms when the workload ratio is comparatively high;3) comprehensive DPTM control system’s managing effect is near to the most ideal one.Efficient thermal analysis plays a key role in the temperature-aware floorplan design forMulti-Processor System-on-Chip (MPSoC) and DPTM. This paper adopts bottom-up modelingmethod to study architecture-level MPSoC thermal analysis method. First extract relative thermalresistance between functional modules with HotSpot software, then, based on these parameters,we propose three analysis methods with different accuracy and algorithm complexity: Block-levelTemperature Analysis Method (BlockTAM), Core-level Temperature Analysis Method (Core-TAM) and Block Inside Core Temperature Analysis Method (BlockInsideCoreTAM). Experimentshows that BlockTAM and BlockInsideCoreTAM substantially reduce the time for MPSoC ther-mal analysis with guarantee of accuracy: speedup as high as 100 times is achieved with averagetemperature delta error as low as 3%. Both are ideal system-level analysis method.

S. Borkar. Thousand Core Chips: A Technology Perspective[C]. Proceedings of the 44th Design Automation Conference, San Diego, USA, 2007. 746–749.
G. Moore. Progress in Digital Integrated Electronics[C]. Proceedings of IEDM Tech Digest, Washigdon D.C., USA, 1975. 11–13.
3. B. Zhai. Theoretical and Practical Limits of Dynamic Voltage Scaling[C]. Proceedings of the 40th Design Automation Conference, San Diego, USA, 2004. 868–873.
4. R. Jejurikar, C. Pereira, R. Gupta. Leakage Aware Dynamic Voltage Scaling for Real-Time Embedded Systems[C]. Proceedings of the 40th Design Automation Conference, San Diego, USA, 2004. 275–280.
5. T. Chantem, R. P. Dick, X. S. Hu. Temperature-aware Scheduling and Assignment for Hard Real-time Applications on MPSoCs[C]. Proceedings of Design, Automation & Test in Europe, Munich, Germany, 2008. 288–293.
6. M. Santarini. Thermal Integrity: A Must for Low-power-IC Digital Design[J]. Sustainable Computing, Informatics and Systems, 2011, 4:286–293.
7. Z. G. Fu, C.S. Sun, Z. Y. Luo. A Task Scheduling Algorithm of Real-time Leakage Power and Temperature Optimization[C]. Proceedings of Computer Aided Design and Computer
Graphics, Yellow Mountain City, China, 2009. 484–491.
8. Berkeley BSIM3 Device Models[Z]. [EB/OL]. http://www.device.EECS.Berkeley.edu/bsim3.
9. H. Sanchez, B. Kuttanna, T. Olson. Thermal Management System for High Performance Power PC Microprocessors[C]. Proceedings of International Conference on Technologies for the Information Superhighway, San Jose, USA, 1997. 325–330.
10. 闫佳琪, 骆祖莹, 唐亮, et al. 考虑温度对漏电流功耗影响的MPSoC结构级热分析方法[J]. 计算机辅助设计与图形学学报, 2013, 25(11):1767–1774.
11. W. Huang, M. R. Stan, K. Sankaranarayanan. Many-core Design from a Thermal Perspective[C]. Proceedings of the 45th Design Automation Conference, Anaheim, California, USA:New York: ACM Press, 2008. 746–749.
12. M. B. Healy, H. H. S. Lee, G. H. Loh. Thermal Optimization in Multi-granularity Multicore Floorplanning[C]. Proceedings of Asia and South Pacific Design Automation Conference. Piscataway, NJ: IEEE Press, 2009. 43–48.
13. K. Michael, R. Sherief. Frequency and Voltage Planning for Multi-core Processors under Thermal Constraints[C]. Proceedings of International Conference on Computer Design, Cancun,Mexico: Los Alamitos: IEEE Computer Society Press, 2008. 463–470.
14. K. Sankaranarayanan, B. H. Meyer, M. R. Stan. Thermal Benefit of Multi-core Floorplanning: A Limits Study[J]. Sustainable Computing, Informatics and Systems, 2011, 4:286–293.
15. V. Hanumaiah, R. Rao, S. Vrudhula. Throughput Optimal Task Allocation under Thermal Constraints for Multi-core Processors[C]. Proceedings of the 46th Design Automation Conference. New York: ACM Press, 2009. 776–781.
16. Y. Ge, Q. R. Qiu. Task Allocation for Minimum System Power in a Homogenous Multi-core Processor[C]. Proceedings of International Green Computing Conference. Los Alamitos: IEEE Computer Society Press, 2010. 299–306.
17. C. L. Lung, Y. L. Ho, D. M. Kwai. Thermal-aware Online Task Allocation for 3D Multi-core Processor Throughput Optimization[C]. Proceedings of Design Automation & Test in Europe, Grenoble, France: New York: ACM Press, 2011. 1–6.
18. D. C. Juan, D. Marculescu. A Learning-based Autoregressive Model for Fast Transient Thermal Analysis of Chip-multiprocessors[C]. Proceedings of Asia and South Pacific Design Automation Conference, Sydney, Australia: Piscataway, NJ: IEEE Press, 2012. 597–602.
19. K Skadron, T. Abdelzaher, R. M. Stan, et al. Control-Theoretic Techniques and Thermal-RC Modeling for Accurate and Localized Dynamic Thermal Management[C]. Proceedings of High Performance Computer Architecture, Boston, USA, 2002. 17–28.
20. K. Skadron, R. M. Stan, K. Sankaranarayanan. Temperature-aware Microarchitecture: Modeling and Implementation[J]. ACM Transactions on Architecture and Code Optimization, 2004, 1(1):94–125.
21. J Srinivasan, S. V. Adve. Predictive Dynamic Thermal Management for Multimedia Applications[C]. Proceedings of International Conference on Supercomputing, San Francisco, USA, 2003. 109–120.
22. L. Yuan, S. Leventhal, G. Qu. Temperature-aware Leakage Minimization Technique for Real-time Systems[C]. Proceedings of International Conference on Computer Aided Design, San Jose, USA: Piscataway, NJ: IEEE Press, 2006. 761–764.
23. C. Y. Yang, L. Thiele, T. W. Kuo. Energy-efficient Real-Time Task Scheduling with Temperature-Dependent Leakage[C]. Proceedings of International Conference on Computer Aided Design, Dresden, Germany, 2010. 9–14.
24. M. Bao, A. Andrei, P. Eles. Temperature-aware Idle Time Distribution for Energy Optimization with Dynamic Voltage Scaling[C]. Proceedings of Design, Automation & Test in Europe, Dresden, Germany, 2010. 21–27.
25. H. Huang, G. Quan. Leakage Aware Energy Minimization for Real-Time Systems under the Maximum Temperature Constraint[C]. Proceedings of Design, Automation & Test in Europe, Grenoble, France, 2011. 479–484.
26. Y. Zhan, B. Goplen, S. S. Sapatnekar. Electrothermal Analysis and Optimization Techniques for Nano-scale Integrated Circuits[C]. Proceedings of Asia and South Pacific Design Automation Conference, Yokohama, Japan: Piscataway, NJ: IEEE Press, 2006. 219–222.
27. W. Huang, S. Ghosh, S. Velusamy. HotSpot: A Compact Thermal Modeling Methodology for Early-stage VLSI Design[J]. IEEE Transactions on Very Large Scale Integration Systems, 2006, 14(5):501–513.
28. M. Janicki, J. H. Collet, A. Louri. HotSpots and Core-to-core Thermal Coupling in Future Multi-core Architectures[C]. Proceedings of the 26th IEEE Semiconductor Thermal Measurement and Management Symposium. Los Alamitos: IEEE Computer Society Press, 2010.
205–210.
29. L. Thiele, S. Chakraborty, M. Naedele. Real-time Calculus for Scheduling Hard Realtime Systems[C]. Proceedings of International Symposium on Circuits and System, Geneva, Switzerland, 2000. 101–104.
30. V. Chaturvedi, H. Huang, G. Quan. Leakage-aware Scheduling on Maximal Temperature Minimization for Periodic Hard Real-time Systems[C]. Proceedings of International Conference on Embedded Software and System, Bradford, UK, 2010. 1802–1809.
31. D. Rai, H. Yang, I. Bacivarov. Worst-Case Temperature Analysis for Real-Time Systems[C]. Proceedings of Design, Automation & Test in Europe, Grenoble, France, 2011. 631–636.
32. 闫佳琪, 骆祖莹, 赵国兴. 基于任务精确预测的实时功耗温度管理[C]. Proceedings of 第十七届全国计算机辅助设计与图形学学术会议暨第九届全国智能CAD与数字娱乐学术会议论文集, 北京: 清华大学出版社. 513–516.
33. 谢乃明, 刘思锋. 离散GM(1,1)模型与灰色预测模型建模机理[J]. 系统工程理论与实践, 2005, 25(1):93–99.
34. 田景文, 高美娟. 人工神经网络算法研究及应用. 北京理工大学出版社, 2006.
35. MATLAB[Z]. [EB/OL]. http://www.mathworks.com/products/matlab/.
36. 骆祖莹,韩银和,赵国兴, et al. 可热扩展的三维并行散热集成方法：用于大规模并行计算的片上系统关键技术[J]. 计算机学报, 2011, 34(04):717–729.
37. K. Skadron, M. R. Stan, W. Huang. Temperature-aware Microarchitecture[C]. Proceedings of International Symposium on Computer Architecture. Los Alamitos: IEEE Computer Society Press, 2003. 2–13.
38. W. P. Liao, L. He, K. M. Lepak. Temperature and Supply Voltage Aware Performance and Power Modeling at Microarchitecture Level[J]. IEEE Transactions on Computer-Aided Design of Integrated Circuits and System, 2005, 24(7):1042–1053.
39. Intel Sandy Bridge-E架构的8核高端CPU[Z]. [OL]. http://ark.intel.com/products/63696.
40. 采用多核结构的iPhone移动设备[Z]. [OL]. http://www.apple.com/cn/iphone/compare/.
41. 采用多核结构的iPad移动设备[Z]. [OL]. http://www.apple.com/cn/ipad/compare/.
42. 手机GPU芯片图形性能跑分横向对比[Z]. [OL]. http://www.dashi.com/article/1148.html.